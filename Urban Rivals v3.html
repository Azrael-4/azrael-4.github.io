<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UR - Combate</title>
    <style>
        * {font-family: Verdana; font-size: 14px;}
    </style>
</head>
<body>
    <!-- Escolha dos Personagens para o Jogador 1 -->
    <div id="jogador1">
        <h3>Cards do Jogador 1</h3>
        <select id="personagemJogador1">
            <optgroup label="Bangers / Ulu Watu">
                <option value="Bangers/Ulu Watu">Bangers/Ulu Watu (ðŸ‘Š: 8, ðŸ”¥: 8, âš¡: PotÃªncia +2)</option>
            </optgroup>
            <optgroup label="All Stars">
                <option value="Oyoh">Oyoh (ðŸ‘Š: 7, ðŸ”¥: 7, âš¡: PotÃªncia adversÃ¡ria -2, mÃ­n 1)</option>
            </optgroup>
            <optgroup label="Junkz / Sentinel">
                <option value="Junkz/Sentinel">Junkz/Sentinel (ðŸ‘Š: 8, ðŸ”¥: 8, âš¡: Ataque +8)</option>
            </optgroup>
            <optgroup label="Sarkrohm">
                <option value="Sarkrohm">Sarkrohm (ðŸ‘Š: 8, ðŸ”¥: 8, âš¡: Ataque adversÃ¡rio -8, mÃ­n 3)</option>
            </optgroup>
            <optgroup label="Fang Pi / La Junta">
                <option value="La Junta">La Junta (ðŸ‘Š: 8, ðŸ”¥: 8, âš¡: Dano +2)</option>
            </optgroup>
            <optgroup label="Pussycats">
                <option value="Pussycats">Pussycats (ðŸ‘Š: 8, ðŸ”¥: 8, âš¡: Dano adversÃ¡rio -2, mÃ­n 1)</option>
            </optgroup>
        </select>
        <label for="pilulasJogador1">PÃ­lulas disponÃ­veis: <span id="pilulasDisponiveisJogador1">12</span></label>
        <br>
        <label for="gastarJogador1">PÃ­lulas para gastar:</label>
        <input type="number" id="gastarJogador1" min="0" max="12" value="0">
    </div>
    
    <!-- Escolha dos Personagens para o Jogador 2 -->
    <div id="jogador2">
        <h3>Jogador 2</h3>
        <select id="personagemJogador2"></select> <!-- Aqui costumava ter uma lista repetida, mas criei uma funÃ§Ã£o para copÃ­ar o deck do jogador1-->
        <label for="pilulasJogador2">PÃ­lulas disponÃ­veis: <span id="pilulasDisponiveisJogador2">12</span></label>
        <br>
        <label for="gastarJogador2">PÃ­lulas para gastar:</label>
        <input type="number" id="gastarJogador2" min="0" max="12" value="0">
    </div>

    <button id="batalhar">Batalhar</button>

<script>
    // VariÃ¡veis Globais
    let totalPilulasJogador1 = 12;
    let totalPilulasJogador2 = 12;

    const personagens = {
        'Bangers/Ulu Watu': { potencia: 8, dano: 0, habilidade: "Derrota: -2 de Vida do oponente, mÃ­nimo 2", modPotencia: (p) => p + 2, modPotenciaAdv: (p) => p, modDano: (p) => p, modDanoAdv: (p) => p, modAtaque: (p) => p, modAtaqueAdv: (p) => p},
        'Oyoh': { potencia: 8, dano: 8, habilidade: "Derrota: -2 de Vida do oponente, mÃ­nimo 2", modPotencia: (p) => p, modPotenciaAdv: (p) => (p < 3 ? 1 : p - 2), modDano: (p) => p, modDanoAdv: (p) => p, modAtaque: (p) => p, modAtaqueAdv: (p) => p},
        'Junkz/Sentinel': { potencia: 8, dano: 8, habilidade: "Derrota: -2 de Vida do oponente, mÃ­nimo 2", modPotencia: (p) => p, modPotenciaAdv: (p) => p, modDano: (p) => p, modDanoAdv: (p) => p, modAtaque: (p) => p+8, modAtaqueAdv: (p) => p},
        'Sarkrohm': { potencia: 8, dano: 8, habilidade: "Derrota: -2 de Vida do oponente, mÃ­nimo 2", modPotencia: (p) => p, modPotenciaAdv: (p) => p, modDano: (p) => p, modDanoAdv: (p) => p, modAtaque: (p) => p, modAtaqueAdv: (p) => (p < 11 ? 3 : p - 8)},
        'La Junta': { potencia: 8, dano: 8, habilidade: "Derrota: -2 de Vida do oponente, mÃ­nimo 2", modPotencia: (p) => p, modPotenciaAdv: (p) => p, modDano: (p) => p+2, modDanoAdv: (p) => p, modAtaque: (p) => p, modAtaqueAdv: (p) => p},
        'Pussycats': { potencia: 8, dano: 8, habilidade: "Derrota: -2 de Vida do oponente, mÃ­nimo 2", modPotencia: (p) => p, modPotenciaAdv: (p) => p, modDano: (p) => p, modDanoAdv: (p) => (p < 3 ? 1 : p - 2), modAtaque: (p) => p, modAtaqueAdv: (p) => p},
    }

    document.getElementById('batalhar').addEventListener('click', function() {
        // Jogador 1 escolhe um personagem
        let personagemJogador1 = document.getElementById('personagemJogador1').value;
        let jogador1Potencia = personagens[personagemJogador1].potencia;
        let jogador1Dano = personagens[personagemJogador1].dano;
        
        // Jogador 2 escolhe um personagem
        let personagemJogador2 = document.getElementById('personagemJogador2').value;
        let jogador2Potencia = personagens[personagemJogador2].potencia;
        let jogador2Dano = personagens[personagemJogador2].dano;
            
        // Aplicar modificadores de PotÃªncia no personagem do jogador 1
        jogador1Potencia = personagens[personagemJogador1].modPotencia(jogador1Potencia);
        jogador1Potencia = personagens[personagemJogador2].modPotenciaAdv(jogador1Potencia);
        // Aplicar modificadores de Dano no personagem do jogador 1
        jogador1Dano = personagens[personagemJogador1].modDano(jogador1Dano);
        jogador1Dano = personagens[personagemJogador2].modDanoAdv(jogador1Dano);
        
        // Aplicar modificadores de PotÃªncia no personagem do jogador 2
        jogador2Potencia = personagens[personagemJogador2].modPotencia(jogador2Potencia);
        jogador2Potencia = personagens[personagemJogador1].modPotenciaAdv(jogador2Potencia);
        // Aplicar modificadores de Dano no personagem do jogador 2
        jogador2Dano = personagens[personagemJogador2].modDano(jogador2Dano);
        jogador2Dano = personagens[personagemJogador1].modDanoAdv(jogador2Dano);

        // Capturar o nÃºmero de pÃ­lulas que o jogador quer gastar e garantir que Ã© um nÃºmero vÃ¡lido <-- Olhar
        let gastarPilulasJogador1 = parseInt(document.getElementById('gastarJogador1').value) || 0;
        let gastarPilulasJogador2 = parseInt(document.getElementById('gastarJogador2').value) || 0;

        // Verificar se o jogador estÃ¡ tentando gastar mais pÃ­lulas do que possui <-- Olhar
        if (gastarPilulasJogador1 > totalPilulasJogador1) gastarPilulasJogador1 = totalPilulasJogador1;
        if (gastarPilulasJogador2 > totalPilulasJogador2) gastarPilulasJogador2 = totalPilulasJogador2;

        // Aplicar o multiplicador das pÃ­lulas gastas Ã  potÃªncia
        let xx = jogador1Potencia;
        let yy = jogador2Potencia;
        
        jogador1Potencia *= (gastarPilulasJogador1 + 1);
        jogador2Potencia *= (gastarPilulasJogador2 + 1);

        // Calculada a PotÃªncia, obtemos o Ataque e agora soma-se/subtrai-se os modificadores de ataque
            // Jogador 1
        jogador1Potencia = personagens[personagemJogador1].modAtaque(jogador1Potencia);
        jogador1Potencia = personagens[personagemJogador2].modAtaqueAdv(jogador1Potencia);
            // Jogador 2
        jogador2Potencia = personagens[personagemJogador2].modAtaque(jogador2Potencia);
        jogador2Potencia = personagens[personagemJogador1].modAtaqueAdv(jogador2Potencia);

        // Subtrair as pÃ­lulas gastas do total de pÃ­lulas disponÃ­veis <-- Olhar
        totalPilulasJogador1 -= gastarPilulasJogador1;
        totalPilulasJogador2 -= gastarPilulasJogador2;

        // Atualizar a exibiÃ§Ã£o de pÃ­lulas restantes
        document.getElementById('pilulasDisponiveisJogador1').textContent = totalPilulasJogador1;
        document.getElementById('pilulasDisponiveisJogador2').textContent = totalPilulasJogador2;

        // Exibe valores finais de ataque apÃ³s habilidades, pÃ­lulas e bÃ´nus
        console.log(personagemJogador1 + "\nAtaque Final = " + xx + 'x' + parseInt(gastarPilulasJogador1 + 1)  + ' = ' + jogador1Potencia);
        console.log(personagemJogador2 + "\nAtaque Final = " + yy + 'x' + parseInt(gastarPilulasJogador2 + 1)  + ' = ' + jogador2Potencia);

        // ELTON
        let ataqueFinalJogador1 = jogador1Potencia;
        let ataqueFinalJogador2 = jogador2Potencia;
        
        // LÃ³gica de quem vence, exibindo o ataque final
        if (ataqueFinalJogador1 > ataqueFinalJogador2) {
                alert(personagemJogador1 + " vence!\n\nAtaque final de " + personagemJogador1 + ": " + ataqueFinalJogador1 + "\nAtaque final de " + personagemJogador2 + ": " + ataqueFinalJogador2 + '\n\nDano causado: ' + jogador1Dano);
            } else if (ataqueFinalJogador2 > ataqueFinalJogador1) {
                alert(personagemJogador2 + " vence!\nAtaque final de " + personagemJogador1 + ": " + ataqueFinalJogador1 + "\nAtaque final de " + personagemJogador2 + ": " + ataqueFinalJogador2 + '\n\nDano causado: ' + jogador2Dano);
            } else {
                alert('Empate!\nAtaque final de ' + personagemJogador1 + ": " + ataqueFinalJogador1 + "\nAtaque final de " + personagemJogador2 + ": " + ataqueFinalJogador2);
            }
    });

    function copiardeckjogador2() {
        document.getElementById('personagemJogador2').innerHTML = document.getElementById('personagemJogador1').innerHTML;
    }

    // FunÃ§Ã£o Start
    copiardeckjogador2();
</script>
</body>
</html>
<!--
Bugs Conhecidos:
Uma potÃªncia/dano/ataque menor que o mÃ­nimo de um oponente que a reduz, eleva o atributo atÃ© o valor mÃ­nimo (ex: dano 0 contra Pussycats torna o dano 1, que o mÃ­nimo das Pussycats)

-->